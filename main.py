# main file for checking a file for probable Malware

import sys
from file_checker import checkFile # Import the checkFile function from the file_checker module
from termcolor import cprint  # Import termcolor at the beginning of the script

def main():
    if len(sys.argv) != 2:
        print("""
Invalid arguments given!
This program is to check if a given file is probable malware or not.

Usage: python3 main.py [file]
Try: python3 main.py malwares/Ransomware/Locky.exe
""")
        exit(1) # Exit the program with a non-zero status code (error)
    filename = sys.argv[1] # Get the filename from the command-line argument
    legitimate = checkFile(filename) # Call the checkFile function to check if the file is legitimate or malware
    # Increase the font size (you can use other attributes as well)
    cprint("\n\n\n********DETECTING MALWARE...********\n\n", 'red', 'on_white', attrs=['bold'])
    
    if legitimate: # If the file is legitimate
        print(f"\nFile name and path :  {sys.argv[1]} \n\nSeems Legitimate File!")
    else: # If the file is suspected to be malware
        print(f"\nFile name and path : {sys.argv[1]} \n\nFile is probably a MALWARE!!!")


if __name__ == "__main__":
    # Execute the main function if this script is run as the main program
    main()
